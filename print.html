<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Nimbus Beacon Chain Book</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="install.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="medalla.html"><strong aria-hidden="true">3.</strong> Become a Medalla validator</a></li><li class="chapter-item expanded "><a href="beacon_node.html"><strong aria-hidden="true">4.</strong> Run the beacon node</a></li><li class="chapter-item expanded "><a href="validator.html"><strong aria-hidden="true">5.</strong> Become a validator (custom)</a></li><li class="chapter-item expanded "><a href="api.html"><strong aria-hidden="true">6.</strong> API</a></li><li class="chapter-item expanded "><a href="advanced.html"><strong aria-hidden="true">7.</strong> Advanced usage for developers</a></li><li class="chapter-item expanded "><a href="faq.html"><strong aria-hidden="true">8.</strong> FAQs</a></li><li class="chapter-item expanded "><a href="contribute.html"><strong aria-hidden="true">9.</strong> Contribute</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">The Nimbus Beacon Chain Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#the-nim-beacon-chain-book" id="the-nim-beacon-chain-book">The nim-beacon-chain book</a></h1>
<p><em>Documentation for Nimbus beacon chain users and developers.</em></p>
<p>The Nimbus beacon chain is a research implementation of the Beacon Chain – the core system level chain at the heart of Ethereum 2.0.</p>
<ul>
<li>
<p>Open sourced at <a href="https://github.com/status-im/nim-beacon-chain/tree/master">github.com/status-im/nim-beacon-chain</a></p>
</li>
<li>
<p>Specification described at <a href="https://github.com/ethereum/eth2.0-specs/tree/v0.12.2#phase-0">ethereum/eth2.0-specs</a></p>
</li>
<li>
<p><a href="https://benjaminion.xyz/eth2-annotated-spec/phase0/beacon-chain/">Annotated Specification</a> </p>
</li>
<li>
<p><a href="./medalla.html">Become a Medalla validator</a></p>
</li>
</ul>
<h2><a class="header" href="#overview" id="overview">Overview</a></h2>
<p>In this book, we will cover:</p>
<ol>
<li>An introduction to the <a href="./faq.html#1-what-is-beacon-chain">beacon chain</a> and <a href="./faq.html#4-what-is-nimbus">Nimbus</a> to equip you with some basic knowledge.</li>
<li><a href="./install.html">Installation steps</a> outlining the prerequisites to get started.</li>
<li><a href="./medalla.html">Become a Medalla validator</a>: If you generated your signing key using the eth2 launchpad, and wish to import it into the Nimbus client, this page is for you.</li>
<li>How to <a href="./beacon_node.html">run the beacon node</a> software to sync the beacon chain.</li>
<li>How to generate keys, deposit, and <a href="./validator.html">become a validator</a> in eth2.</li>
<li>The <a href="./api.html">API</a> for monitoring your node through <code>http</code>.</li>
<li><a href="./advanced.html">Advanced usage</a> for developers.</li>
<li>Common <a href="./faq.html">questions and answers</a> to satisfy your curiosity.</li>
<li>How to <a href="./contribute.html">contribute</a> to this book.</li>
</ol>
<p>Feel free to give us feedback on how to improve :)</p>
<h2><a class="header" href="#get-in-touch" id="get-in-touch">Get in touch</a></h2>
<p>Need help with anything? Join us using <a href="https://join.status.im/nimbus-general">Status</a> or <a href="https://discord.gg/9dWwPnG">Discord</a>!</p>
<h2><a class="header" href="#disclaimer" id="disclaimer">Disclaimer</a></h2>
<p>This documentation assumes Nimbus is in its ideal state. The project is still under active development. Please submit a <a href="https://github.com/status-im/nim-beacon-chain/issues">Github issue</a> if you come across a problem.</p>
<!-- > > > TODO:

1. fill up the gitbook content
2. write questions in the faq.md page -->
<h1><a class="header" href="#installation" id="installation">Installation</a></h1>
<p>The Beacon chain can run on Linux, macOS, Windows, and Android. At the moment, Nimbus has to be built from source.</p>
<h2><a class="header" href="#time" id="time">Time</a></h2>
<p>The beacon chain relies on your computer having the correct time set, down to at most 0.5 seconds.</p>
<p>We recommended you run a high quality time service on your computer such as:</p>
<ul>
<li>GPS</li>
<li>NTS (network time security, IETF draft)</li>
<li>Roughtime (google)</li>
</ul>
<p>As a minimum, you should run an NTP client on the server.</p>
<p>If that makes no sense to you, don't worry. For testnets, just making sure your computer is set at the correct time should be fine.</p>
<h2><a class="header" href="#external-dependencies" id="external-dependencies">External Dependencies</a></h2>
<ul>
<li>Developer tools (C compiler, Make, Bash, Git)</li>
<li>PCRE</li>
</ul>
<p>Nim is not an external dependency, Nimbus will build its own local copy.</p>
<h2><a class="header" href="#linux" id="linux">Linux</a></h2>
<p>On common Linux distributions the dependencies can be installed with:</p>
<pre><code class="language-sh"># Debian and Ubuntu
sudo apt-get install build-essential git libpcre3-dev

# Fedora
dnf install @development-tools pcre

# Archlinux, using an AUR manager for pcre-static
yourAURmanager -S base-devel pcre-static
</code></pre>
<h3><a class="header" href="#macos" id="macos">macOS</a></h3>
<p>Assuming you use <a href="https://brew.sh/">Homebrew</a> to manage packages</p>
<pre><code class="language-sh">brew install pcre cmake
</code></pre>
<h3><a class="header" href="#windows" id="windows">Windows</a></h3>
<p>You can install the developer tools by following the instruction in our <a href="./advanced.html#windows-dev-environment">Windows dev environment section</a>.
It also provides a downloading script for prebuilt PCRE.</p>
<h3><a class="header" href="#android" id="android">Android</a></h3>
<ul>
<li>Install the <a href="https://termux.com">Termux</a> app from FDroid or the Google Play store</li>
<li>Install a <a href="https://wiki.termux.com/wiki/PRoot">PRoot</a> of your choice following the instructions for your preferred distribution.
Note, the Ubuntu PRoot is known to contain all Nimbus prerequisites compiled on Arm64 architecture (common architecture for Android devices).</li>
</ul>
<p><em>Assuming Ubuntu PRoot is used</em></p>
<pre><code class="language-sh">apt install build-essential git libpcre3-dev
</code></pre>
<h2><a class="header" href="#next-steps" id="next-steps">Next steps</a></h2>
<p>Once you've installed the prerequisites, you're ready to move on to <a href="./medalla.html">running a validator on Medalla</a>.</p>
<h1><a class="header" href="#become-a-medalla-validator" id="become-a-medalla-validator">Become a Medalla validator</a></h1>
<p>This page will take you through how to become a validator on the eth2 testnet <a href="https://github.com/goerli/medalla">Medalla</a>.</p>
<p>If you generated your signing key using the <a href="https://medalla.launchpad.ethereum.org/">eth2 launchpad</a>, and wish to import it into the Nimbus client, this page is for you.</p>
<blockquote>
<p>If you haven't created your validator key yet, we recommend you go through the <a href="https://medalla.launchpad.ethereum.org/">launchpad first</a>. If you're not sure what the eth2 launchpad is, we recommend reading this <a href="https://blog.ethereum.org/2020/07/27/eth2-validator-launchpad/">introductory post</a>.</p>
</blockquote>
<h2><a class="header" href="#prerequisites" id="prerequisites">Prerequisites</a></h2>
<p>If this is your first time playing with Nimbus, make sure you <a href="./install.html">install our external dependencies</a> first.</p>
<p>This tutorial assumes basic knowledge of the <a href="https://www.learnenough.com/command-line-tutorial/basics#:%7E:text=Learn%20Enough%20Command%20Line%20to%20Be%20Dangerous%20is%20an%20introduction,broad%20an%20audience%20as%20possible.">command line</a>.</p>
<h2><a class="header" href="#validating" id="validating">Validating</a></h2>
<p>To start validating on the <code>medalla</code> network:</p>
<h4><a class="header" href="#1-clone-the-nim-beacon-chain-repository" id="1-clone-the-nim-beacon-chain-repository">1. Clone the nim beacon chain repository</a></h4>
<pre><code>git clone https://github.com/status-im/nim-beacon-chain
cd nim-beacon-chain
git checkout devel
</code></pre>
<h4><a class="header" href="#2-build-the-beacon-node" id="2-build-the-beacon-node">2. Build the beacon node</a></h4>
<pre><code>make beacon_node
</code></pre>
<p><em>Patience... this may take a few minutes.</em></p>
<h4><a class="header" href="#3-import-keystores" id="3-import-keystores">3. Import keystore(s)</a></h4>
<pre><code>build/beacon_node deposits import  --data-dir=build/data/shared_medalla_0 &lt;YOUR VALIDATOR KEYS DIRECTORY&gt;
</code></pre>
<p>Replacing <code>&lt;YOUR VALIDATOR KEYS DIRECTORY&gt;</code> with the full pathname of your <code>validator_keys</code> directory.</p>
<blockquote>
<p>Tip: run <code>pwd</code> in your <code>validator_keys</code> directory to print the full pathname to the console.</p>
</blockquote>
<p>You'll be asked to enter the password you created to encrypt your keystore(s) in the <em>Generate Keys</em> section of the Launchpad process. Don't worry, this is entirely normal. Your validator client needs both your keystore(s) and the password encrypting it to import your <a href="https://blog.ethereum.org/2020/05/21/keys/">keys</a> (since it needs to decrypt the keystore in order to be able to use it to sign on your behalf).</p>
<h4><a class="header" href="#4-connect-to-medalla" id="4-connect-to-medalla">4. Connect to Medalla</a></h4>
<pre><code>make medalla
</code></pre>
<p>This will build Nimbus and its dependencies, and connect you to Medalla.
You should see that the beacon node has launched with your validator attached and is waiting for <a href="https://hackmd.io/@benjaminion/genesis">genesis</a> to start:</p>
<pre><code>WRN 2020-08-03 16:24:17.950+02:00 Validator not in registry (yet?)           topics=&quot;beacval&quot; tid=11677993 file=validator_duties.nim:53 pubKey=a9c4df36
INF 2020-08-03 16:24:17.951+02:00 Local validator attached                   tid=11677993 file=validator_pool.nim:21 pubKey=a9c4df36 validator=a9c4df36
INF 2020-08-03 16:24:17.951+02:00 Local validators attached                  topics=&quot;beacval&quot; tid=11677993 file=validator_duties.nim:61 count=1
INF 2020-08-03 16:24:17.958+02:00 Starting beacon node                       topics=&quot;beacnde&quot; tid=11677993 file=beacon_node.nim:875 version=&quot;0.5.0 (31b33907)&quot; nim=&quot;Nim Compiler Version 1.2.6 [MacOSX: amd64] (bf320ed1)&quot; timeSinceFinalization=81350 head=ebe49843:0 finalizedHead=ebe49843:0 SLOTS_PER_EPOCH=32 SECONDS_PER_SLOT=12 SPEC_VERSION=0.12.2 dataDir=build/data/shared_medalla_0 pcs=start_beacon_node
NOT 2020-08-03 16:24:17.958+02:00 Waiting for genesis                        topics=&quot;beacnde&quot; tid=11677993 file=beacon_node.nim:890 genesisIn=22h35m50s0ns
</code></pre>
<h4><a class="header" href="#5-keep-an-eye-on-your-validator" id="5-keep-an-eye-on-your-validator">5. Keep an eye on your validator</a></h4>
<p>If you deposited after the <a href="https://hackmd.io/@benjaminion/genesis">genesis</a> state was decided (August 2nd 1300 UTC), your validators will have been put in a queue based on deposit time, and will slowly be inducted into the validator set after genesis. Getting through the queue may take a few hours or days.</p>
<p>The best way to keep track of your validator's status is <a href="https://medalla.beaconcha.in">medalla.beaconcha.in</a> (click on the orange magnifying glass at the very top and paste in its public key). </p>
<p>You can even <a href="https://medalla.beaconcha.in/register">create an account</a> to add alerts and keep track it its <a href="https://medalla.beaconcha.in/dashboard">performance</a>.</p>
<p>Finally, makes sure you stay on the lookout for any critical updates to Nimbus. This best way to do so is through our <a href="https://discord.com/invite/XRxWahP">discord</a>.</p>
<p>Looking forward to seeing you on Medalla! 💛</p>
<h3><a class="header" href="#a-note-on-keys" id="a-note-on-keys">A note on keys</a></h3>
<p>The Nimbus client will only ever import your signing key -- in any case, if you used the deposit launchpad, this is the only key you should have (you can generate the withdrawal key from your mnemonic when you wish to withdraw). The keys your Nimbus client has access to are stored in the <code>build/data/shared_medalla_0/</code> folder, under <code>secrets</code> and <code>validators</code>.</p>
<p>The <code>secrets</code> folder contains the common secret that gives you access to all your validator keys. And the <code>validators</code> folder contains your keystores.</p>
<p>For more on keys in eth2, see <a href="https://blog.ethereum.org/2020/05/21/keys/">here</a>.</p>
<h1><a class="header" href="#the-beacon-node" id="the-beacon-node">The beacon node</a></h1>
<p>The beacon node application connects to the eth2 network, manages the blockchain, and provides API's to interact with the beacon chain.</p>
<p>You can run the beacon node without being a validator - doing so allows you to sync the network and access its latest state.</p>
<h2><a class="header" href="#prerequisites-1" id="prerequisites-1">Prerequisites</a></h2>
<p>Before compiling and running the application, make sure you've gone through the <a href="./install.html">installation guidelines</a>.</p>
<h2><a class="header" href="#running-the-node" id="running-the-node">Running the node</a></h2>
<p>When running the beacon node, you connect to a specific ethereum 2 network - this may be a private network or a public testnet like <a href="https://github.com/goerli/medalla/">Medalla</a>.</p>
<p>When running the node for the first time, you need to specify network parameters, boot nodes and genesis information. This information can typically be found in the <a href="https://github.com/eth2-clients/eth2-testnets">eth2 testnets</a> repository. This information is automatically downloaded when using the simplified startup.</p>
<p>Once the beacon node is running, it will first connect to the boot nodes in the network, look for more peers and start syncing the chain. Once the sync is complete, it will keep following the head of the chain (you can interact with it through the <a href="./api.html">API</a>.</p>
<p>Before running the beacon node, it's important that your computer is set to the correct time - preferably using a trusted time source (this can be an NTP server you trust, GPS time or another precise source of time) -- however don't worry if you're unsure of how to do this, it isn't essential for testnet purposes.</p>
<h3><a class="header" href="#syncing" id="syncing">Syncing</a></h3>
<p>To start syncing the <code>medalla</code> network:</p>
<h4><a class="header" href="#1-clone-the-nim-beacon-chain-repository-1" id="1-clone-the-nim-beacon-chain-repository-1">1. Clone the nim beacon chain repository</a></h4>
<pre><code>git clone https://github.com/status-im/nim-beacon-chain
cd nim-beacon-chain
</code></pre>
<h4><a class="header" href="#2-run-the-build-process" id="2-run-the-build-process">2. Run the build process</a></h4>
<pre><code>make medalla

# Build output...

</code></pre>
<p>This will build Nimbus and its dependencies, and connect you to Medalla.
You should see that the beacon node has launched and started syncing.</p>
<pre><code>INF 2020-07-03 15:28:15+02:00 Starting beacon node                       topics=&quot;beacnde&quot; tid=176865 file=beacon_node.nim:866 SECONDS_PER_SLOT=12 SLOTS_PER_EPOCH=32 SPEC_VERSION=0.12.1 cat=init dataDir=/home/arnetheduck/status/nim-beacon-chain/build/data/shared_medalla_0 finalizedRoot=72e7b21c finalizedSlot=20064 headRoot=f92bf720 headSlot=20142 nim=&quot;Nim Compiler Version 1.2.2 [Linux: amd64] (be34b5ab)&quot; pcs=start_beacon_node timeSinceFinalization=-108322 version=&quot;0.5.0 (c64737e)&quot;


 peers: 7 ❯ finalized: 3a806c9f:634 ❯ head: b364f8e9:636:29 ❯ time: 909:7 (29095)              ETH: 0.0
</code></pre>
<h3><a class="header" href="#status-bar" id="status-bar">Status bar</a></h3>
<p>The status bar shows important health information about your node:</p>
<ul>
<li>peers - The number of peers you're connected to</li>
<li>finalized - The block root and epoch of the latest finalized checkpoint - when the network is healthy, this value will stay at 2-3 epochs from the wall clock</li>
<li>head - The block root and time of the head block - as blocks are produced and processed, this will be updated to the latest head block as chosen by the consensus algorithm.</li>
<li>time - The current wall time according to your computer - when the node is synced, the head block will closely follow this time.</li>
<li>ETH: the total ETH validators attached to the node have accumulated. When there are no validators attached, this number will be 0.</li>
</ul>
<p>Time is shown as <code>epoch:subslot</code>, starting from the block chain genesis time - one epoch is typically 32 slots but this may vary between networks.</p>
<p>The status bar content may be updated using command line flags.</p>
<h3><a class="header" href="#metrics" id="metrics">Metrics</a></h3>
<p>Nimbus includes metrics support using the Prometheus format. To enable it, you need to enable insecure feature when compiling the application. The http server that exports Prometheus metrics should not be exposed to external parties.</p>
<pre><code># Compile with insecure features enabled
make NIMFLAGS=&quot;-d:insecure&quot; medalla
</code></pre>
<h2><a class="header" href="#command-line-options" id="command-line-options">Command line options</a></h2>
<pre><code>$ ./beacon_node --help
Nimbus beacon node v0.3.0 (877a358)

Usage:

beacon_node [OPTIONS]... command

The following options are available:

     --log-level               Sets the log level.
     --eth1-network            The Eth1 network tracked by the beacon node.
 -d, --data-dir                The directory where nimbus will store all blockchain data.
     --web3-url                URL of the Web3 server to observe Eth1.
     --deposit-contract        Address of the deposit contract.
     --deposit-contract-block  The Eth1 block hash where the deposit contract has been deployed.
     --non-interactive         Do not display interative prompts. Quit on missing configuration.
 -b, --bootstrap-node          Specifies one or more bootstrap nodes to use when connecting to the network.
     --bootstrap-file          Specifies a line-delimited file of bootstrap Ethereum network addresses.
     --listen-address          Listening address for the Ethereum LibP2P traffic.
     --tcp-port                Listening TCP port for Ethereum LibP2P traffic.
     --udp-port                Listening UDP port for node discovery.
     --max-peers               The maximum number of peers to connect to.
     --nat                     Specify method to use for determining public address. Must be one of: any, none,
                               upnp, pmp, extip:&lt;IP&gt;.
 -v, --validator               Path to a validator keystore.
     --validators-dir          A directory containing validator keystores.
     --secrets-dir             A directory containing validator keystore passwords.
     --wallets-dir             A directory containing wallet files.
 -s, --state-snapshot          Json file specifying a recent state snapshot.
     --node-name               A name for this node that will appear in the logs. If you set this to 'auto', a
                               persistent automatically generated ID will be selected for each --data-dir
                               folder.
     --verify-finalization     Specify whether to verify finalization occurs on schedule, for testing.
     --stop-at-epoch           A positive epoch selects the epoch at which to stop.
     --metrics                 Enable the metrics server.
     --metrics-address         Listening address of the metrics server.
     --metrics-port            Listening HTTP port of the metrics server.
     --status-bar              Display a status bar at the bottom of the terminal screen.
     --status-bar-contents     Textual template for the contents of the status bar.
     --rpc                     Enable the JSON-RPC server.
     --rpc-port                HTTP port for the JSON-RPC service.
     --rpc-address             Listening address of the RPC server.
     --dump                    Write SSZ dumps of blocks, attestations and states to data dir.

Available sub-commands:

beacon_node_shared_medalla_0 createTestnet [OPTIONS]...

The following options are available:

     --validators-dir          Directory containing validator keystores.
     --total-validators        The number of validator deposits in the newly created chain.
     --first-validator         Index of first validator to add to validator list.
     --last-user-validator     The last validator index that will free for taking from a testnet participant.
     --bootstrap-address       The public IP address that will be advertised as a bootstrap node for the
                               testnet.
     --bootstrap-port          The TCP/UDP port that will be used by the bootstrap node.
     --genesis-offset          Seconds from now to add to genesis time.
     --output-genesis          Output file where to write the initial state snapshot.
     --with-genesis-root       Include a genesis root in 'network.json'.
     --output-bootstrap-file   Output file with list of bootstrap nodes for the network.

beacon_node_shared_medalla_0 deposits [OPTIONS]... command

The following options are available:

     --deposit-private-key     Private key of the controlling (sending) account.

Available sub-commands:

beacon_node_shared_medalla_0 deposits create [OPTIONS]...

Creates validator keystores and deposits.

The following options are available:

     --count                   Number of deposits to generate.
     --wallet                  An existing wallet ID. If not specified, a new wallet will be created.
     --out-validatorss-dir     Output folder for validator keystores and deposits.
     --out-secrets-dir         Output folder for randomly generated keystore passphrases.
     --dont-send               By default, all created deposits are also immediately sent to the validator
                               deposit contract. You can use this option to prevent this behavior. Use the
                               `deposits send` command to send the deposit transactions at your convenience
                               later.

beacon_node_shared_medalla_0 deposits send [OPTIONS]...

Sends prepared deposits to the validator deposit contract.

The following options are available:

     --validators-dir          A folder with validator metadata created by the `deposits create` command.
     --min-delay               Minimum possible delay between making two deposits (in seconds).
     --max-delay               Maximum possible delay between making two deposits (in seconds).

beacon_node_shared_medalla_0 deposits status

Displays status information about all deposits.

beacon_node_shared_medalla_0 wallets command

Available sub-commands:

beacon_node_shared_medalla_0 wallets create [OPTIONS]...

Creates a new EIP-2386 wallet.

The following options are available:

     --name                    An easy-to-remember name for the wallet of your choice.
     --next-account            Initial value for the 'nextaccount' property of the wallet.
     --out                     Output wallet file.

beacon_node_shared_medalla_0 wallets restore [OPTIONS]...

Restores a wallet from cold storage.

The following options are available:

     --name                    An easy-to-remember name for the wallet of your choice.
     --deposits                Expected number of deposits to recover. If not specified, Nimbus will try to
                               guess the number by inspecting the latest beacon state.
     --out                     Output wallet file.

beacon_node_shared_medalla_0 wallets list

Lists details about all wallets.
</code></pre>
<h2><a class="header" href="#next-steps-1" id="next-steps-1">Next steps</a></h2>
<p>Once you're synced, you can move on to become a <a href="./validator.html">validator</a>.</p>
<h1><a class="header" href="#become-a-validator" id="become-a-validator">Become a Validator</a></h1>
<blockquote>
<p>Note, the instructions below currently apply to Altona. They will be updated shortly to explain how you can use Nimbus to create your validator keys and interact with the Medalla deposit contract.</p>
<p>To become a validator on Medalla using the <a href="https://medalla.launchpad.ethereum.org/">eth2 launchpad</a>, see <a href="./medalla.html">here</a>.</p>
</blockquote>
<p>To become a validator, you need to install the beacon chain software, acquire 32 ETH, set up your validator account, and register with the deposit contract on ethereum.
There is currently no eth2 mainnet - all networks are testnets.</p>
<h2><a class="header" href="#recommended-testnets" id="recommended-testnets">Recommended Testnets</a></h2>
<p>Though Nimbus can connect to any of the testnets published in the <a href="https://github.com/eth2-clients/eth2-testnets/tree/master/nimbus">eth2-clients/eth2-testnets repo</a>, below are the recommended ones:</p>
<ul>
<li>Multi-client Testnet: <a href="https://github.com/goerli/altona">altona</a> (<a href="https://altona.beaconcha.in">explorer</a>)</li>
<li>Nimbus Testnet: testnet0 (experimental, not always active)</li>
</ul>
<h2><a class="header" href="#altona" id="altona">Altona</a></h2>
<h3><a class="header" href="#initial-setup" id="initial-setup">Initial setup</a></h3>
<p>Before we start, we have to obtain 32 ETH on the Goerli testnet (later on, we'll need to send this ETH to the deposit contract in order to become a validator).</p>
<ol>
<li>Open your <a href="https://metamask.io/">MetaMask</a> wallet, switch to the <code>Goerli Test Network</code> option from the top right corner.</li>
<li>Copy your account address by clicking on one of your accounts.</li>
<li>Post your account address on a social media platform (Twitter or Facebook). Copy the url to the post.</li>
<li>Paste your post url on the <a href="https://faucet.goerli.mudit.blog/">Goerli faucet</a> and select <code>Give me Ether &gt; 37.5 Ethers</code> from the top right corner of the page.</li>
<li>Wait for a few seconds and return to your MetaMask wallet to check if you have successfully received the ETH.</li>
<li>Once the <a href="./install.html">prerequisites</a> are installed, you can connect to the altona testnet with the following commands: <br></li>
</ol>
<ul>
<li><strong><em>Remember to replace <code>make</code> with <code>mingw32-make</code> if using Windows.</em></strong></li>
</ul>
<pre><code class="language-bash">git clone https://github.com/status-im/nim-beacon-chain
cd nim-beacon-chain
git checkout devel
git pull
make update
make altona        # This will build Nimbus and all other dependencies
                   # and connect you to altona
</code></pre>
<p><em>Once Nimbus has finished building, you will be prompted to enter the private key of the account you want to deposit the 32 ETH from.</em></p>
<img src="./img/connect_testnet.PNG" alt="" style="margin: 0 40 0 40"/>
<ol start="7">
<li>Copy your private key from MetaMask (click on the three dots in the top right, followed by <strong>Account Details</strong> and <strong>Export Private Key</strong>).</li>
</ol>
<img src="./img/metamask_export_private_1.png" alt="" width="200" style="margin: 0 40 0 40"/>
<img src="./img/metamask_export_private_2.png" alt="" width="200" style="padding-left: 60px; padding-right: 60px; margin: 0 40 0 40"/>
<img src="./img/metamask_export_private_3.png" alt="" width="200" style="margin: 0 40 0 40"/>
<ol start="8">
<li>Paste your private key into the console.</li>
</ol>
<img src="./img/enter_private_key.PNG" alt="" style="margin: 0 40 0 40"/>
<ol start="9">
<li>Press enter and wait for a few seconds until you see <em>Deposit sent</em>.</li>
</ol>
<pre><code>INF 2020-07-05 12:58:25+02:00 Generating deposits ... validatorsDir=/Users/sssaintleger/nim-beacon-chain/build/data/shared_altona_0/validators ...
INF 2020-07-05 12:58:25+02:00 Sending deposits ... DepositContract=0x16e82D77882A663454Ef92806b7DeCa1D394810f ...
INF 2020-07-05 12:58:26+02:00 Deposit sent ... status=0x5455b1faf773a535668bdd4ade6b03f6cfd52f88414a5ad74bbdfdfd89f28b86

Deposit sent, wait for confirmation then press enter to continue
</code></pre>
<ol start="10">
<li>Check the status of your deposit by copying and pasting the transaction hash into <a href="https://goerli.etherscan.io/">https://goerli.etherscan.io/</a> (where the transacton hash is the text displayed after <code>status=</code> in your console). For example, in the output displayed after step 9,  we have <code>status=0x5455...</code> so the transaction hash is  <code>0x5455...</code>. If you see a green <em>Success</em> box (see the image below)  you can go ahead and press enter to continue.</li>
</ol>
<img src="./img/deposit-transaction-details.png" alt="" style="margin: 0 40 0 40"/>
<blockquote>
<p>Note: it should take approximately 8 hours for your deposit to be processed by the beacon chain. To keep track of the status of your validator you should go to <a href="https://altona.beaconcha.in/validators/eth1deposits">https://altona.beaconcha.in/validators/eth1deposits/[Validator PubKey]</a>, replacing [Validator PubKey] with your actual Validator PubKey -- you can find this in the etherscan transaction details (for example, in the image above the Validator PubKey is  <code>0x95aa...</code>).</p>
</blockquote>
<p>And voila! That's all there is to it :)</p>
<p>The beacon chain client will start syncing the network while your deposit is being processed. As soon as it has synced, and your validator has been confirmed as active, the client will start performing validation duties.</p>
<p>P.S.  at the bottom of the console, you should see something like:</p>
<pre><code>peers: 18 &gt; finalized: 710631d5:283 &gt; head: 98204d1:285:10 &gt; time: 1405:2 (44982)
ETH: 0
</code></pre>
<p>You can get a brief estimate of the time remaining until you've synced to the network by comparing <code>head</code> with <code>time</code> (<code>time</code> gives the current epoch, whereas <code>head</code> tells you how many epochs you've synced so far). From the above output, we see that the number of epochs synced so far is <code>285</code>, and the current epoch is <code>1405</code>.</p>
<h3><a class="header" href="#upgrading" id="upgrading">Upgrading</a></h3>
<p>When you restart the beacon node, the software will resume from where it left off, using your previous deposits.</p>
<pre><code>cd nim-beacon-chain
git pull
make update # Update dependencies
make altona # Restart using same keys as last run
</code></pre>
<h2><a class="header" href="#key-management" id="key-management">Key management</a></h2>
<p>Keys are stored in the <code>build/data/[testnet_name]/</code> folder, under <code>secrets</code> and <code>validators</code> - make sure you keep these folders backed up.</p>
<p>The <code>secrets</code> folder contains the common secret that gives you access to all your validator keys.</p>
<p>The <code>validators</code> folder contains your keystores. Keystores are used by validators as a method for exchanging keys. </p>
<p>For more on keys in eth2, see <a href="https://blog.ethereum.org/2020/05/21/keys/">here</a>.</p>
<h2><a class="header" href="#metrics-1" id="metrics-1">Metrics</a></h2>
<p>Metrics are not included in the binary by default - to enable them, use the following options when starting the client:</p>
<pre><code>make NIMFLAGS=&quot;-d:insecure&quot; altona
</code></pre>
<p>You can then browse the metrics by connecting to:</p>
<p>http://localhost:8008/metrics</p>
<p>Make sure this port is protected as the http server used is not considered secure (it should not be used by untrusted peers).</p>
<h2><a class="header" href="#troubleshooting" id="troubleshooting">Troubleshooting</a></h2>
<ol>
<li>
<p>The directory that stores the blockchain data of the testnet is <code>build/data/shared_altona_0</code> (if you're connecting to another testnet, replace <code>altona</code> with that testnet's name). Delete this folder if you want to start over (for example, if you entered a wrong private key).</p>
</li>
<li>
<p>Currently, you have to switch to the <code>devel</code> branch in order to run the validator node successfully.</p>
</li>
<li>
<p>Everytime you want to update your node to the latest version, run <code>git pull</code>, <code>make update</code>, and then <code>make altona</code>.</p>
</li>
<li>
<p>If <code>make update</code> causes the console to hang for too long, try running <code>make update V=1</code> or <code>make update V=2</code> instead (these will print a more verbose output to the console which may make it easier to diagnose the problem).</p>
</li>
</ol>
<p>NBC exposes API:s for querying the state of the application at runtime.</p>
<p>:note: Where applicable, this API mimics https://github.com/ethereum/eth2.0-APIs with the exception that JSON-RPC is used instead of http rest - method names, parameters and results are equivalent except for the encoding / access method.</p>
<h2><a class="header" href="#introduction" id="introduction">Introduction</a></h2>
<p>The NBC API is implemented using JSON-RPC 2.0. To query it, you can use a JSON-RPC library in the language of your choice, or a tool like <code>curl</code> to access it from the command line. A tool like <a href="https://stedolan.github.io/jq/">jq</a> is helpful to pretty-print the responses.</p>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;id&quot;,&quot;method&quot;:&quot;peers&quot;,&quot;params&quot;:[] }' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<p>Before you can access the API, make sure it's enabled using the RPC flag (<code>beacon_node --rpc</code>):</p>
<pre><code>     --rpc                     Enable the JSON-RPC server.
     --rpc-port                HTTP port for the JSON-RPC service.
     --rpc-address             Listening address of the RPC server.
</code></pre>
<p>One difference is that currently endpoints that correspond to specific ones from the <a href="https://ethereum.github.io/eth2.0-APIs/">spec</a> are named weirdly - for example an endpoint such as <a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getGenesis"><code>getGenesis</code></a> is currently named <code>get_v1_beacon_genesis</code> which would map 1:1 to the actual REST path in the future - verbose but unambiguous.</p>
<h2><a class="header" href="#beacon-node-api" id="beacon-node-api">Beacon Node API</a></h2>
<h3><a class="header" href="#getbeaconhead" id="getbeaconhead">getBeaconHead</a></h3>
<p>The latest head slot, as chosen by the latest fork choice.</p>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;id&quot;,&quot;method&quot;:&quot;getBeaconHead&quot;,&quot;params&quot;:[] }' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#getchainhead" id="getchainhead">getChainHead</a></h3>
<p>Show chain head information, including head, justified and finalized checkpoints.</p>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;id&quot;,&quot;method&quot;:&quot;getChainHead&quot;,&quot;params&quot;:[] }' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#getsyncing" id="getsyncing">getSyncing</a></h3>
<h3><a class="header" href="#getbeaconblock" id="getbeaconblock">getBeaconBlock</a></h3>
<h3><a class="header" href="#getbeaconstate" id="getbeaconstate">getBeaconState</a></h3>
<h3><a class="header" href="#getnetworkpeerid" id="getnetworkpeerid">getNetworkPeerId</a></h3>
<h3><a class="header" href="#getnetworkpeers" id="getnetworkpeers">getNetworkPeers</a></h3>
<h3><a class="header" href="#getnetworkenr" id="getnetworkenr">getNetworkEnr</a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;id&quot;,&quot;method&quot;:&quot;getNetworkEnr&quot;,&quot;params&quot;:[] }' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetgenesisget_v1_beacon_genesisa" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetgenesisget_v1_beacon_genesisa"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getGenesis"><code>get_v1_beacon_genesis</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_beacon_genesis&quot;,&quot;params&quot;:[],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetstaterootget_v1_beacon_states_roota" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetstaterootget_v1_beacon_states_roota"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getStateRoot"><code>get_v1_beacon_states_root</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_beacon_states_root&quot;,&quot;params&quot;:[&quot;finalized&quot;],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetstateforkget_v1_beacon_states_forka" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetstateforkget_v1_beacon_states_forka"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getStateFork"><code>get_v1_beacon_states_fork</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_beacon_states_fork&quot;,&quot;params&quot;:[&quot;finalized&quot;],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetstatefinalitycheckpointsget_v1_beacon_states_finality_checkpointsa" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetstatefinalitycheckpointsget_v1_beacon_states_finality_checkpointsa"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getStateFinalityCheckpoints"><code>get_v1_beacon_states_finality_checkpoints</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_beacon_states_finality_checkpoints&quot;,&quot;params&quot;:[&quot;finalized&quot;],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetstatevalidatorsget_v1_beacon_states_stateid_validatorsa" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetstatevalidatorsget_v1_beacon_states_stateid_validatorsa"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getStateValidators"><code>get_v1_beacon_states_stateId_validators</code></a></a></h3>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetstatevalidatorget_v1_beacon_states_stateid_validators_validatorida" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetstatevalidatorget_v1_beacon_states_stateid_validators_validatorida"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getStateValidator"><code>get_v1_beacon_states_stateId_validators_validatorId</code></a></a></h3>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetepochcommitteesget_v1_beacon_states_stateid_committees_epocha" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetepochcommitteesget_v1_beacon_states_stateid_committees_epocha"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getEpochCommittees"><code>get_v1_beacon_states_stateId_committees_epoch</code></a></a></h3>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetblockheadersget_v1_beacon_headersa" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetblockheadersget_v1_beacon_headersa"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getBlockHeaders"><code>get_v1_beacon_headers</code></a></a></h3>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetblockheaderget_v1_beacon_headers_blockida" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetblockheaderget_v1_beacon_headers_blockida"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getBlockHeader"><code>get_v1_beacon_headers_blockId</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_beacon_headers_blockId&quot;,&quot;params&quot;:[&quot;finalized&quot;],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetblockget_v1_beacon_blocks_blockida" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetblockget_v1_beacon_blocks_blockida"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getBlock"><code>get_v1_beacon_blocks_blockId</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_beacon_blocks_blockId&quot;,&quot;params&quot;:[&quot;finalized&quot;],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetblockrootget_v1_beacon_blocks_blockid_roota" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetblockrootget_v1_beacon_blocks_blockid_roota"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getBlockRoot"><code>get_v1_beacon_blocks_blockId_root</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_beacon_blocks_blockId_root&quot;,&quot;params&quot;:[&quot;finalized&quot;],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeacongetblockattestationsget_v1_beacon_blocks_blockid_attestationsa" id="a-hrefhttpsethereumgithubioeth20-apisbeacongetblockattestationsget_v1_beacon_blocks_blockid_attestationsa"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/getBlockAttestations"><code>get_v1_beacon_blocks_blockId_attestations</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_beacon_blocks_blockId_attestations&quot;,&quot;params&quot;:[&quot;finalized&quot;],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisbeaconsubmitpoolattestationspost_v1_beacon_pool_attestationsa" id="a-hrefhttpsethereumgithubioeth20-apisbeaconsubmitpoolattestationspost_v1_beacon_pool_attestationsa"><a href="https://ethereum.github.io/eth2.0-APIs/#/Beacon/submitPoolAttestations"><code>post_v1_beacon_pool_attestations</code></a></a></h3>
<h2><a class="header" href="#valdiator-api" id="valdiator-api">Valdiator API</a></h2>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapiproduceblockget_v1_validator_blocka" id="a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapiproduceblockget_v1_validator_blocka"><a href="https://ethereum.github.io/eth2.0-APIs/#/ValidatorRequiredApi/produceBlock"><code>get_v1_validator_block</code></a></a></h3>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapipublishblockpost_v1_validator_blocka" id="a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapipublishblockpost_v1_validator_blocka"><a href="https://ethereum.github.io/eth2.0-APIs/#/ValidatorRequiredApi/publishBlock"><code>post_v1_validator_block</code></a></a></h3>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapiproduceattestationget_v1_validator_attestationa" id="a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapiproduceattestationget_v1_validator_attestationa"><a href="https://ethereum.github.io/eth2.0-APIs/#/ValidatorRequiredApi/produceAttestation"><code>get_v1_validator_attestation</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_validator_attestation_data&quot;,&quot;params&quot;:[0,3],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapigetaggregatedattestationget_v1_validator_aggregate_and_proofa" id="a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapigetaggregatedattestationget_v1_validator_aggregate_and_proofa"><a href="https://ethereum.github.io/eth2.0-APIs/#/ValidatorRequiredApi/getAggregatedAttestation"><code>get_v1_validator_aggregate_and_proof</code></a></a></h3>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapipublishaggregateandproofpost_v1_validator_aggregate_and_proofa" id="a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapipublishaggregateandproofpost_v1_validator_aggregate_and_proofa"><a href="https://ethereum.github.io/eth2.0-APIs/#/ValidatorRequiredApi/publishAggregateAndProof"><code>post_v1_validator_aggregate_and_proof</code></a></a></h3>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapigetattesterdutiespost_v1_validator_duties_attestera" id="a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapigetattesterdutiespost_v1_validator_duties_attestera"><a href="https://ethereum.github.io/eth2.0-APIs/#/ValidatorRequiredApi/getAttesterDuties"><code>post_v1_validator_duties_attester</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;post_v1_validator_duties_attester&quot;,&quot;params&quot;:[1,[&quot;a7a0502eae26043d1ac39a39457a6cdf68fae2055d89c7dc59092c25911e4ee55c4e7a31ade61c39480110a393be28e8&quot;,&quot;a1826dd94cd96c48a81102d316a2af4960d19ca0b574ae5695f2d39a88685a43997cef9a5c26ad911847674d20c46b75&quot;]],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapigetproposerdutiesget_v1_validator_duties_proposera" id="a-hrefhttpsethereumgithubioeth20-apisvalidatorrequiredapigetproposerdutiesget_v1_validator_duties_proposera"><a href="https://ethereum.github.io/eth2.0-APIs/#/ValidatorRequiredApi/getProposerDuties"><code>get_v1_validator_duties_proposer</code></a></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;id&quot;,&quot;method&quot;:&quot;get_v1_validator_duties_proposer&quot;,&quot;params&quot;:[1] }' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h2><a class="header" href="#config" id="config">Config</a></h2>
<h3><a class="header" href="#a-hrefhttpsethereumgithubioeth20-apisconfiggetforkscheduleget_v1_config_fork_schedulea" id="a-hrefhttpsethereumgithubioeth20-apisconfiggetforkscheduleget_v1_config_fork_schedulea"><a href="https://ethereum.github.io/eth2.0-APIs/#/Config/getForkSchedule"><code>get_v1_config_fork_schedule</code></a></a></h3>
<h2><a class="header" href="#administrative--debug-api" id="administrative--debug-api">Administrative / Debug API</a></h2>
<h3><a class="header" href="#get_v1_debug_beacon_states_stateid---returns-an-entire-beaconstate-object-for-the-specified-stateid" id="get_v1_debug_beacon_states_stateid---returns-an-entire-beaconstate-object-for-the-specified-stateid"><code>get_v1_debug_beacon_states_stateId</code> - returns an entire <code>BeaconState</code> object for the specified <code>stateId</code></a></h3>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;get_v1_debug_beacon_states_stateId&quot;,&quot;params&quot;:[&quot;head&quot;],&quot;id&quot;:1}' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#getnodeversion" id="getnodeversion">getNodeVersion</a></h3>
<p>Show version of the software</p>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;id&quot;,&quot;method&quot;:&quot;getNodeVersion&quot;,&quot;params&quot;:[] }' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#getspecpreset" id="getspecpreset">getSpecPreset</a></h3>
<p>Show spec constants in use.</p>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;id&quot;,&quot;method&quot;:&quot;getSpecPreset&quot;,&quot;params&quot;:[] }' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h3><a class="header" href="#peers" id="peers">peers</a></h3>
<p>Show a list of peers that the beacon node is connected to.</p>
<pre><code>curl -d '{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;id&quot;,&quot;method&quot;:&quot;peers&quot;,&quot;params&quot;:[] }' -H 'Content-Type: application/json' localhost:9190 -s | jq
</code></pre>
<h1><a class="header" href="#advanced-usage-for-developers" id="advanced-usage-for-developers">Advanced Usage for Developers</a></h1>
<p>Latest updates happen in the <code>devel</code> branch which is merged into <code>master</code> every week on Tuesday before deploying a new testnets
The following sections explain how to setup your build environment on your platform.</p>
<h3><a class="header" href="#windows-dev-environment" id="windows-dev-environment">Windows dev environment</a></h3>
<p>Install Mingw-w64 for your architecture using the &quot;<a href="https://sourceforge.net/projects/mingw-w64/files/">MinGW-W64 Online
Installer</a>&quot; (first link
under the directory listing). Run it and select your architecture in the setup
menu (<code>i686</code> on 32-bit, <code>x86_64</code> on 64-bit), set the threads to <code>win32</code> and
the exceptions to &quot;dwarf&quot; on 32-bit and &quot;seh&quot; on 64-bit. Change the
installation directory to &quot;C:\mingw-w64&quot; and add it to your system PATH in &quot;My
Computer&quot;/&quot;This PC&quot; -&gt; Properties -&gt; Advanced system settings -&gt; Environment
Variables -&gt; Path -&gt; Edit -&gt; New -&gt; C:\mingw-w64\mingw64\bin (it's &quot;C:\mingw-w64\mingw32\bin&quot; on 32-bit)</p>
<p>Install <a href="https://gitforwindows.org/">Git for Windows</a> and use a &quot;Git Bash&quot; shell to clone and build nim-beacon-chain.</p>
<p>If you don't want to compile PCRE separately, you can fetch pre-compiled DLLs with:</p>
<pre><code class="language-bash">mingw32-make # this first invocation will update the Git submodules
mingw32-make fetch-dlls # this will place the right DLLs for your architecture in the &quot;build/&quot; directory
</code></pre>
<blockquote>
<p>If you were following the Windows testnet instructions, you can jump back to <a href="advanced.html#connecting-to-testnets">Connecting to testnets</a> now</p>
</blockquote>
<p>You can now follow those instructions in the previous section by replacing <code>make</code> with <code>mingw32-make</code> (regardless of your 32-bit or 64-bit architecture):</p>
<pre><code class="language-bash">mingw32-make test # run the test suite
</code></pre>
<h3><a class="header" href="#linux-macos" id="linux-macos">Linux, macOS</a></h3>
<p>After cloning the repo:</p>
<pre><code class="language-bash"># Build beacon_node and all the tools, using 4 parallel Make jobs
make -j4

# Run tests
make test

# Update to latest version
git pull
make update
</code></pre>
<p>To run a command that might use binaries from the Status Nim fork:</p>
<pre><code class="language-bash">./env.sh bash # start a new interactive shell with the right env vars set
which nim
nim --version # Nimbus is tested and supported on 1.0.2 at the moment

# or without starting a new interactive shell:
./env.sh which nim
./env.sh nim --version
</code></pre>
<h3><a class="header" href="#raspberry-pi" id="raspberry-pi">Raspberry Pi</a></h3>
<p>We recommend you remove any cover or use a fan; the Raspberry Pi will get hot (85°C) and throttle.</p>
<ul>
<li>Raspberry PI 3b+ or Raspberry Pi 4b.</li>
<li>64gb SD Card (less might work too, but the default recommended 4-8GB will probably be too small)</li>
<li><a href="https://www.raspberrypi.org/downloads/raspbian/">Raspbian Buster Lite</a> - Lite version is enough to get going and will save some disk space!</li>
</ul>
<p>Assuming you're working with a freshly written image:</p>
<pre><code class="language-bash">
# Start by increasing swap size to 2gb:
sudo vi /etc/dphys-swapfile
# Set CONF_SWAPSIZE=2048
# :wq
sudo reboot

# Install prerequisites
sudo apt-get install git libgflags-dev libsnappy-dev libpcre3-dev

# Then you can follow instructions for Linux.

</code></pre>
<h3><a class="header" href="#makefile-tips-and-tricks-for-developers" id="makefile-tips-and-tricks-for-developers">Makefile tips and tricks for developers</a></h3>
<ul>
<li>build all those tools known to the Makefile:</li>
</ul>
<pre><code class="language-bash"># $(nproc) corresponds to the number of cores you have
make -j$(nproc)
</code></pre>
<ul>
<li>build a specific tool:</li>
</ul>
<pre><code class="language-bash">make state_sim
</code></pre>
<ul>
<li>you can control the Makefile's verbosity with the V variable (defaults to 0):</li>
</ul>
<pre><code class="language-bash">make V=1 # verbose
make V=2 test # even more verbose
</code></pre>
<ul>
<li>same for the <a href="https://github.com/status-im/nim-chronicles#chronicles_log_level">Chronicles log level</a>:</li>
</ul>
<pre><code class="language-bash">make LOG_LEVEL=DEBUG bench_bls_sig_agggregation # this is the default
make LOG_LEVEL=TRACE beacon_node # log everything
</code></pre>
<ul>
<li>pass arbitrary parameters to the Nim compiler:</li>
</ul>
<pre><code class="language-bash">make NIMFLAGS=&quot;-d:release&quot;
</code></pre>
<ul>
<li>you can freely combine those variables on the <code>make</code> command line:</li>
</ul>
<pre><code class="language-bash">make -j$(nproc) NIMFLAGS=&quot;-d:release&quot; USE_MULTITAIL=yes eth2_network_simulation
</code></pre>
<ul>
<li>don't use the <a href="https://github.com/status-im/nim-beacon-chain/pull/745">lightweight stack tracing implementation from nim-libbacktrace</a>:</li>
</ul>
<pre><code class="language-bash">make USE_LIBBACKTRACE=0 # expect the resulting binaries to be 2-3 times slower
</code></pre>
<h1><a class="header" href="#frequently-asked-questions" id="frequently-asked-questions">Frequently Asked Questions</a></h1>
<h2><a class="header" href="#what-is-beacon-chain" id="what-is-beacon-chain">What is Beacon Chain?</a></h2>
<p>A complete introduction about the beacon chain can be found in the <a href="https://our.status.im/two-point-oh-the-beacon-chain/">Ethereum 2.0 blog series</a>.</p>
<p>In short, the beacon chain is a <strong>new type of blockchain</strong> to help the Ethereum blockchain to smoothly transfer its consensus algorithm from PoW (Proof of Work) to PoS (Proof of Stake), aka Ethereum 2.0.</p>
<h2><a class="header" href="#differences-between-beacon-chain-and-ethereum-10" id="differences-between-beacon-chain-and-ethereum-10">Differences Between Beacon Chain and Ethereum 1.0</a></h2>
<p>In traditional PoW, those that propose new blocks are called <strong><em>miners</em></strong>, whereas in PoS, they are called <strong><em>validators</em></strong>. In essence, <em>miners</em> rely on actual hardware (such as some specifically manufactured mining machines), while <em>validators</em> rely on just software and a good network connection.</p>
<h2><a class="header" href="#what-it-is-like-to-be-a-validator" id="what-it-is-like-to-be-a-validator">What it is Like to Be a Validator?</a></h2>
<p>It is obvious that you must have enough computing power or dedicated hardware in order to be a miner, but how about being a validator? Here is a brief overview:</p>
<ol>
<li>A special smart contract named <strong><em>deposit contract</em></strong> is deployed on the original Ethereum blockchain. Note that in this case, the new beacon chain and the original blockchain co-exists.</li>
<li>To &quot;register&quot; as a validator, you have to first deposit <strong><em>32 Ether</em></strong> from your account to this smart contract.</li>
<li>Run the beacon node and wait for the network to sync before your validator is activated.</li>
<li>That's all! Remember to stay connected to the network, or you may lose some of your deposit, as punishment, depending on how long you're offline. :P</li>
</ol>
<h2><a class="header" href="#what-is-nimbus" id="what-is-nimbus">What is Nimbus?</a></h2>
<p>In a sentence, Nimbus is an Ethereum 1.0 &amp; 2.0 Client for Resource-Restricted Devices.</p>
<p>It is open sourced at <a href="github.com/status-im/nimbus">github.com/status-im/nimbus</a>. Development progress and updates can be viewed at the <a href="https://our.status.im/tag/nimbus/">Nimbus blog</a>.</p>
<h2><a class="header" href="#why-are-metrics-not-working" id="why-are-metrics-not-working">Why are metrics not working?</a></h2>
<p>Metrics are currently implemented using a HTTP server that hasn't been hardened sufficiently that it can be exposed as a public endpoint - it must thus be enabled specifically during build:</p>
<pre><code>make NIMFLAGS=&quot;-d:insecure&quot;
beacon_node --metrics ...
</code></pre>
<h1><a class="header" href="#contribute" id="contribute">Contribute</a></h1>
<p>Follow these steps to contribute to this book!</p>
<p>We use an utility tool called mdBook to create online books from Markdown files.</p>
<h2><a class="header" href="#before-you-start" id="before-you-start">Before You Start</a></h2>
<ol>
<li>Install mdBook from <a href="https://github.com/rust-lang/mdBook">here</a>.</li>
<li>Clone the repository by <code>git clone https://github.com/status-im/nim-beacon-chain.git</code>.</li>
<li>Go to where the Markdown files are located by <code>cd docs</code>.</li>
</ol>
<h2><a class="header" href="#real-time-update-and-preview-changes" id="real-time-update-and-preview-changes">Real-Time Update and Preview Changes</a></h2>
<ol>
<li>Run <code>mdbook serve</code> in the terminal.</li>
<li>Preview the book at <a href="http://localhost:3000">http://localhost:3000</a>.</li>
</ol>
<h2><a class="header" href="#build-and-deploy" id="build-and-deploy">Build and Deploy</a></h2>
<p>The first step is to submit a pull request to the <a href="https://github.com/status-im/nim-beacon-chain/tree/devel">devel branch</a>.
Then, after it is merged, do the following under our main repository:</p>
<ol>
<li><code>cd nim-beacon-chain</code></li>
<li><code>git checkout devel</code></li>
<li><code>git pull</code></li>
<li><code>make update</code> (This is to update the submodules to the latest version)</li>
<li><code>make publish-book</code></li>
</ol>
<h2><a class="header" href="#trouble-shooting" id="trouble-shooting">Trouble Shooting</a></h2>
<p>If you see file conflicts in the pull request, this may due to that you have created your new branch from an old version of the <code>devel</code> branch. Update your new branch using the following commands:</p>
<pre><code>git checkout devel
git pull
make update
git checkout readme
git merge devel
# use something like `git mergetool` to resolve conflicts, then read the instructions for completing the merge (usually just a `git commit`)
# check the output of `git diff devel`
</code></pre>
<p>Thank you so much for your help to the decentralized and open source community. :)</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
